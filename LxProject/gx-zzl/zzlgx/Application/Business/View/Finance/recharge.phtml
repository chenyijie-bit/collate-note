<?php require_once MODULE_PATH.'/View/Common/header.phtml'; ?>
<style>
@font-face {font-family: "iconfont";
  src: url('iconfont.eot?t=1508746119286'); /* IE9*/
  src: url('iconfont.eot?t=1508746119286#iefix') format('embedded-opentype'), /* IE6-IE8 */
  url('data:application/x-font-woff;charset=utf-8;base64,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') format('woff'),
  url('iconfont.ttf?t=1508746119286') format('truetype'), /* chrome, firefox, opera, Safari, Android, iOS 4.2+*/
  url('iconfont.svg?t=1508746119286#iconfont') format('svg'); /* iOS 4.1- */
}
.iconfont {
  font-family:"iconfont" !important;
  font-size:25px;
  font-style:normal;
  color: #00A8F2;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
.icon-zhifubao:before { content: "\e676"; }
.icon-zhifubao1:before { content: "\e615"; }
.active-pay{
  border: 2px solid #00A8F2;
}
</style>

<body class="gray-bg">
    <div class="wrapper wrapper-content animated fadeInRight">
       
        <div class="row">
            <div class="col-sm-12">
                <div class="ibox float-e-margins">
                  <div class="ibox-title">
                            <h5>共享币充值</h5>
                             <span class="label label-primary pull-right label-primary-cust">
                                <?php if($_GET['back'] == 'true'): ?>
                                <a href="javascript:history.back(-1);" class="fa-lg-cust-a" title="返回上一页">
                                    <i class="fa fa-arrow-left fa-lg-cust"  aria-hidden="true"></i>
                                </a>
                                <?php endif; ?>
                            </span> 
                        </div>
                    <div class="ibox-content">
                    <div class="alert alert-warning" >
                            <?php $security = $security * 10; ?>
                            提示：您现在共有共享币 <span class="alert-link"><?php echo $piao+$security; ?></span> 个<?php echo $security > 0 ? "（含保证金 {$security} 个）" : ''; ?>，人民币兑共享币的充值比例为 1:10，例如您充值 1 元，您将得到 10 个共享币，首次充值需要交纳保证金 <?php echo $systemSecurity; ?> 元。
                        </div>
                        <form class="form-horizontal m-t">
                            <div class="form-group">
                                <label class="col-sm-3 control-label">商户ID：</label>
                                <div class="col-sm-8">
                                    <input name="business_id" type="text" class="form-control" value="<?php echo $business_id; ?>" disabled>
                                </div>
                            </div>
                          	 <div class="form-group">
                                <label class="col-sm-3 control-label">充值方式：</label>
                                <div class="col-sm-8">
                                    <div class="radio i-checks">
                                        <label>
                                            <i class="iconfont icon-zhifubao1 active-pay" style="position: absolute;left: 0px;top: -4px;"></i>
                                            <input name="bank_id" type="hidden" value="1">
                                        </label>
                                    </div>
                                </div>
                            </div>
							<div class="form-group">
                                <label class="col-sm-3 control-label">充值共享币（个）：</label>
                                <div class="col-sm-8">
                                    <input name="piao" type="number" class="form-control piao-count" placeholder="请输入要充值共享币数" onkeyup="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}" onafterpaste="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}" >
                                </div>
                            </div>
                             <div class="form-group">
                                <label class="col-sm-3 control-label">所需金额（元）：</label>
                                <div class="col-sm-8">
                                    <input name="rmb" type="number" class="form-control rmb-count" disabled>
                                </div>
                            </div>
                            <div class="form-group form-group-bottom">
                                <div class="col-sm-2 col-sm-offset-3">
                                    <p class="btn btn-danger" onclick="javascript:enterPay();">确定充值</p>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

<?php require_once MODULE_PATH.'/View/Common/footer.phtml'; ?>

<script>

    $(document).ready(function(){
        $('#active-pay').click(function () {
            $(this).toggleClass("active-pay")
        });
    });
    $('.piao-count').bind('keyup change',function () {
     var piaoCount=$(this).val();
     $('.rmb-count').val(piaoCount/10);
    })
    
    //确定充值
    function enterPay(){
      if( $('.piao-count').val()==''){
             swal('请填全所需信息', "", "warning");
             return;
        }
        swal({
            title: "确定要进行本次共享币充值吗？",
            text: "",
            type: "warning",
            showCancelButton: true,
            confirmButtonColor: "#DD6B55",
            confirmButtonText: "检查无误，确认",
            cancelButtonText: "取消",
            closeOnConfirm: false,
            closeOnCancel: true
        },
        function(isConfirm) {
            if (isConfirm) {
                $.ajax({
                    cache: true,
                    type: "POST",
                    url:"/Business/Finance/recharge",
                    data:$('form').serialize(),
                    dataType: 'json',
                    async: false,
                    error: function(data) {
                       swal('网络错误，请重试！', "", "warning");
                    },
                    success: function(data) {
                        if (data.error){
                            swal(data.msg, "", "error");
                            return false;
                        }else{
                            window.location.href = data.url;
                        }
                    }
                });
            }
        })
    }

</script>